# Build packages from HPC team

# axis that defines software deployment strategy
axis:
  - architecture
  - compiler
  - mpi
  - lapack
  - python

# toolchain combinations
combinations: !include packages/toolchains.yaml

parallel-packages: &parallel-specs
  specs:
    - functionalizer@3.11.0
    - neurodamus@plasticity
    - neurodamus@master
    - neurodamus@hippocampus
    - neuron@2018-10
    - spykfunc@0.11.0
    - touchdetector@4.3.3

# list of packages to build
packages:
  # with default gnu, intel toolchains + mpi
  gnu-intel-parallel:
    target_matrix:
      - gnu-stable
      - intel-stable
    requires:
      - architecture
      - compiler
    <<: *parallel-specs

  # with default gnu, intel toolchains + mpi + lapack
  gnu-intel-lapack-parallel:
    target_matrix:
      - gnu-stable
      - intel-stable
    requires:
      - architecture
      - compiler
      - lapack
    specs:
      - steps@3.3.0+petsc

  # packages from nse tream
  gnu-intel-lapack-python-parallel:
    target_matrix:
      - gnu-stable
      - intel-stable
    requires:
      - architecture
      - compiler
      - lapack
      - python
    specs:
      - py-bluepymm@0.6.35
      - py-bluepyopt@1.6.56
      - py-efel@3.0.22
